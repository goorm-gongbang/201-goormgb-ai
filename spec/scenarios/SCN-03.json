{
  "id": "SCN-03",
  "name": "Forced Challenge right after Queue Pass",
  "initial_state": "S0",
  "policy_profile": "default",
  "events": [
    { "event_type": "FLOW_START", "source": "mock" },
    { "event_type": "ENTRY_ENABLED", "source": "mock" },
    { "event_type": "QUEUE_PASSED", "source": "mock" },
    { "event_type": "DEF_CHALLENGE_FORCED", "source": "defense", "context": { "tier": "elevated" } },
    { "event_type": "CHALLENGE_APPEARED", "source": "mock", "stage": "S3", "context": { "challenge_type": "captcha" } },
    { "event_type": "CHALLENGE_PASSED", "source": "mock", "stage": "S3", "context": { "solve_time_ms": 12000 } },
    { "event_type": "SECTION_SELECTED", "source": "mock", "stage": "S4" },
    { "event_type": "HOLD_ACQUIRED", "source": "mock", "stage": "S5" },
    { "event_type": "PAYMENT_COMPLETED", "source": "mock", "stage": "S6" }
  ],
  "accept": {
    "final_state": "SX",
    "terminal_reason": "done",
    "asserts": [
      { "type": "state_path_contains", "value": ["S3"] },
      { "type": "returned_to_last_non_security_state", "value": "S4" }
    ]
  }
}
